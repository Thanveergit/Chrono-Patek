<%- include("../layout/commonHeader.ejs")%>


    <!-- zoom for the product image -->
<link rel="stylesheet" href="/assets/css/zoom.css">

<style>
	
	.offer-badge-circle {
    position: absolute;
    top: 10px; /* Adjust the top position */
    right: 10px; /* Adjust the right position */
    background-color: red; /* Red background for the badge */
    color: white; /* White text */
    width: 40px; /* Fixed width for the badge */
    height: 40px; /* Fixed height to make it circular */
    border-radius: 50%; /* Circular shape */
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 14px; /* Font size for the discount percentage */
    font-weight: bold; /* Bold text */
    z-index: 1; /* Ensure the badge appears above the image */
}
#wishlist-btn {
    background-color: #222; /* Primary background color */
    color: #fff; /* Text color */
    border: 1px solid #555; /* Border matching the background */
}

#wishlist-btn:hover {
    background-color: #717fe0; /* Hover background color */
    border-color: #717fe0; /* Border color on hover */
    color: #fff; /* Text color on hover */
}


</style>
	


	<!-- breadcrumb -->
	<div class="container">
		<div class="bread-crumb flex-w p-l-25 p-r-15 p-t-30 p-lr-0-lg">
			<a href="/" class="stext-109 cl8 hov-cl1 trans-04">
				home
				<i class="fa fa-angle-right m-l-9 m-r-10" aria-hidden="true"></i>
			</a>

			<a href="/shope" class="stext-109 cl8 hov-cl1 trans-04">
				shop
				<i class="fa fa-angle-right m-l-9 m-r-10" aria-hidden="true"></i>
			</a>

			<span class="stext-109 cl4">
				<%= product.productName %>
			</span>
		</div>
	</div>
		

	<!-- Product Detail -->
	<section class="sec-product-detail bg0 p-t-65 p-b-60">
		<div class="container">
			<div class="row">
				<div class="col-md-6 col-lg-7 p-b-30">
					<div class="p-l-25 p-r-30 p-lr-0-lg">
						<div class="wrap-slick3 flex-sb flex-w">
							<div class="wrap-slick3-dots"></div>
							<div class="wrap-slick3-arrows flex-sb-m flex-w"></div>

							<div class="slick3 gallery-lb">
								<% product.image.forEach(image=>{ %>
								<div class="item-slick3" data-thumb="/uploads/product-images/<%=image %>">
									<div class="wrap-pic-w pos-relative">
										<img src="/uploads/product-images/<%=image %>" alt="IMG-PRODUCT">

										<a class="flex-c-m size-108 how-pos1 bor0 fs-16 cl10 bg0 hov-btn3 trans-04" href="/uploads/product-images/<%=image %>">
											<i class="fa fa-expand"></i>
										</a>
									</div>
								</div>
								<% }) %>
							</div>
						</div>
					</div>
				</div>
					
				<div class="col-md-6 col-lg-5 p-b-30">
					<div class="p-r-50 p-t-5 p-lr-0-lg">
						<h4 class="mtext-105 cl2 js-name-detail p-b-14">
							<%=product.productName %>
						</h4>

						<!-- <span class="mtext-106 cl2">
							₹<%= product.price %>
						</span> -->

						<span class="mtext-106 cl2">
							<% if (product.offerPrice) { %>
							    <span style="text-decoration: line-through;">₹ <%= product.price %></span>
							    ₹ <%= product.offerPrice %>
							<% } else { %>
							    ₹ <%= product.price %>
							<% } %>
						  </span>

						<p class="stext-102 cl3 p-t-23">
							<%=product.productDetails%>
						</p>
						<br>
						<!--  -->


						<span class="mtext-100 cl2"></span>
							<% if (product.quantity >= 10) { %>
								<span style="color: green;">in stock</span>
							<% } else if (product.quantity > 0) { %>
								<span style="color: peru;">only <%= product.quantity %> left in stock</span>
							<% } else { %>
								<span style="color: red;">out of stock</span>
							<% } %>
						</span><br><br>


						<!-- <div class="pt-5"></div>
							<ul>
								<a class="mtext-104 cl2" style="color: #008B8B;">Highlights</a><br>    
								<% for(let i = 0; i < product.highlights.length; i++){ %>
									<li class="highlight-point"><%= product.highlights[i] %></li>
								<% } %>
							</ul>
						</div><br><br> -->


						<!-- <div class="p-t-33">
							<div class="flex-w flex-r-m p-b-10">
								<div class="size-203 flex-c-m respon6">
									Size
								</div>

								<div class="size-204 respon6-next">
									<div class="rs1-select2 bor8 bg0">
										<select class="js-select2" name="time">
											<option>Choose an option</option>
											<option>Size S</option>
											<option>Size M</option>
											<option>Size L</option>
											<option>Size XL</option>
										</select>
										<div class="dropDownSelect2"></div>
									</div>
								</div>
							</div>

							<div class="flex-w flex-r-m p-b-10">
								<div class="size-203 flex-c-m respon6">
									Color
								</div>

								<div class="size-204 respon6-next">
									<div class="rs1-select2 bor8 bg0">
										<select class="js-select2" name="time">
											<option>Choose an option</option>
											<option>Red</option>
											<option>Blue</option>
											<option>White</option>
											<option>Grey</option>
										</select>
										<div class="dropDownSelect2"></div>
									</div>
								</div>
							</div> -->

							<!-- <div class="flex-w flex-r-m p-b-10">
								<div class="size-204 flex-w flex-m respon6-next">
									<div class="wrap-num-product flex-w m-r-20 m-tb-10">
										<div class="btn-num-product-down cl8 hov-btn3 trans-04 flex-c-m">
											<i class="fs-16 zmdi zmdi-minus"></i>
										</div>

										<input class="mtext-104 cl3 txt-center num-product" type="number" name="num-product" value="1" disabled>

										<div class="btn-num-product-up cl8 hov-btn3 trans-04 flex-c-m">
											<i class="fs-16 zmdi zmdi-plus"></i>
										</div>
									</div> -->

									<!-- <button class="flex-c-m stext-101 cl0 size-101 bg2 bor1 hov-btn1 p-lr-15 trans-04 js-addwishlist-detail" data-product-id="<%= product._id %>">
										Add to Wishlist
									 </button>
									 
									<button class="flex-c-m stext-101 cl0 size-101 bg1 bor1 hov-btn1 p-lr-15 trans-04 js-addcart-detail" data-product-id="<%= product._id %>">
										Add to cart
									 </button> -->

									 <div class="button-container" style="display: flex; gap: 10px;">
										<button class="flex-c-m stext-101 cl0 size-101 bg2 bor1 hov-btn1 p-lr-15 trans-04 js-addwishlist-detail" id="wishlist-btn" data-product-id="<%= product._id %>">
										    Add to Wishlist
										</button>
									 
										<button class="flex-c-m stext-101 cl0 size-101 bg1 bor1 hov-btn1 p-lr-15 trans-04 js-addcart-detail" data-product-id="<%= product._id %>">
										    Add to cart
										</button>
									 </div>
									 
								</div>
							</div>	
						</div>

						<!--  -->
						<div class="flex-w flex-m p-l-100 p-t-40 respon7">
							<div class="flex-m bor9 p-r-10 m-r-11">
								<a href="#" class="fs-14 cl3 hov-cl1 trans-04 lh-10 p-lr-5 p-tb-2 js-addwish-detail tooltip100" data-tooltip="Add to Wishlist">
									<i class="zmdi zmdi-favorite"></i>
								</a>
							</div>

							<a href="#" class="fs-14 cl3 hov-cl1 trans-04 lh-10 p-lr-5 p-tb-2 m-r-8 tooltip100" data-tooltip="Facebook">
								<i class="fa fa-facebook"></i>
							</a>

							<a href="#" class="fs-14 cl3 hov-cl1 trans-04 lh-10 p-lr-5 p-tb-2 m-r-8 tooltip100" data-tooltip="Twitter">
								<i class="fa fa-twitter"></i>
							</a>

							<a href="#" class="fs-14 cl3 hov-cl1 trans-04 lh-10 p-lr-5 p-tb-2 m-r-8 tooltip100" data-tooltip="Google Plus">
								<i class="fa fa-google-plus"></i>
							</a>
						</div>
					</div>
				</div>
			</div>

			<div class="bor10 m-t-50 p-t-43 p-b-40">
				<!-- Tab01 -->
				<div class="tab01">
					<!-- Nav tabs -->
					<ul class="nav nav-tabs" role="tablist">
						<li class="nav-item p-b-10">
							<a class="nav-link active" data-toggle="tab" href="#description" role="tab">Description</a>
						</li>

						<li class="nav-item p-b-10">
							<a class="nav-link" data-toggle="tab" href="#information" role="tab">Additional information</a>
						</li>

						<li class="nav-item p-b-10">
							<a class="nav-link" data-toggle="tab" href="#reviews" role="tab">Reviews (1)</a>
						</li>
					</ul>

					<!-- Tab panes -->
					<div class="tab-content p-t-43">
						<!-- - -->
						<div class="tab-pane fade show active" id="description" role="tabpanel">
							<div class="how-pos2 p-lr-15-md">
								<p class="stext-102 cl6">
									<%=product.productDesc %>
								</p>
							</div>
						</div>

						<!-- - -->
						<div class="tab-pane fade" id="information" role="tabpanel">
							<div class="row">
								<%for(let i=0;i<=product.highlights.length;i+=2){%>
								<div class="col-sm-10 col-md-8 col-lg-6 m-lr-auto">
									<ul class="p-lr-28 p-lr-15-sm">
										<li class="flex-w flex-t p-b-7">
											<span class="stext-102 cl3 size-205">
												Weight
											</span>

											<span class="stext-102 cl6 size-206">
												<%= product.highlights[i]%>
											</span>
										</li>

										<li class="flex-w flex-t p-b-7">
											<span class="stext-102 cl3 size-205">
												Dimensions
											</span>

											<span class="stext-102 cl6 size-206">
												<%= product.highlights[1]%>
											</span>
										</li>

										<li class="flex-w flex-t p-b-7">
											<span class="stext-102 cl3 size-205">
												Materials
											</span>

											<span class="stext-102 cl6 size-206">
												60% cotton
											</span>
										</li>

										<li class="flex-w flex-t p-b-7">
											<span class="stext-102 cl3 size-205">
												Color
											</span>

											<span class="stext-102 cl6 size-206">
												Black, Blue, Grey, Green, Red, White
											</span>
										</li>

										<li class="flex-w flex-t p-b-7">
											<span class="stext-102 cl3 size-205">
												Size
											</span>

											<span class="stext-102 cl6 size-206">
												XL, L, M, S
											</span>
										</li>
									</ul>
								</div>
								<%}%>
							</div>
						</div>

						<!-- - -->
						<div class="tab-pane fade" id="reviews" role="tabpanel">
							<div class="row">
								<div class="col-sm-10 col-md-8 col-lg-6 m-lr-auto">
									<div class="p-b-30 m-lr-15-sm">
										<!-- Review -->
										<div class="flex-w flex-t p-b-68">
											<div class="wrap-pic-s size-109 bor0 of-hidden m-r-18 m-t-6">
												<img src="/assets/images/avatar-01.jpg" alt="AVATAR">
											</div>

											<div class="size-207">
												<div class="flex-w flex-sb-m p-b-17">
													<span class="mtext-107 cl2 p-r-20">
														Ariana Grande
													</span>

													<span class="fs-18 cl11">
														<i class="zmdi zmdi-star"></i>
														<i class="zmdi zmdi-star"></i>
														<i class="zmdi zmdi-star"></i>
														<i class="zmdi zmdi-star"></i>
														<i class="zmdi zmdi-star-half"></i>
													</span>
												</div>

												<p class="stext-102 cl6">
													Quod autem in homine praestantissimum atque optimum est, id deseruit. Apud ceteros autem philosophos
												</p>
											</div>
										</div>
										
										<!-- Add review -->
										<form class="w-full">
											<h5 class="mtext-108 cl2 p-b-7">
												Add a review
											</h5>

											<p class="stext-102 cl6">
												Your email address will not be published. Required fields are marked *
											</p>

											<div class="flex-w flex-m p-t-50 p-b-23">
												<span class="stext-102 cl3 m-r-16">
													Your Rating
												</span>

												<span class="wrap-rating fs-18 cl11 pointer">
													<i class="item-rating pointer zmdi zmdi-star-outline"></i>
													<i class="item-rating pointer zmdi zmdi-star-outline"></i>
													<i class="item-rating pointer zmdi zmdi-star-outline"></i>
													<i class="item-rating pointer zmdi zmdi-star-outline"></i>
													<i class="item-rating pointer zmdi zmdi-star-outline"></i>
													<input class="dis-none" type="number" name="rating">
												</span>
											</div>

											<div class="row p-b-25">
												<div class="col-12 p-b-5">
													<label class="stext-102 cl3" for="review">Your review</label>
													<textarea class="size-110 bor8 stext-102 cl2 p-lr-20 p-tb-10" id="review" name="review"></textarea>
												</div>

												<div class="col-sm-6 p-b-5">
													<label class="stext-102 cl3" for="name">Name</label>
													<input class="size-111 bor8 stext-102 cl2 p-lr-20" id="name" type="text" name="name">
												</div>

												<div class="col-sm-6 p-b-5">
													<label class="stext-102 cl3" for="email">Email</label>
													<input class="size-111 bor8 stext-102 cl2 p-lr-20" id="email" type="text" name="email">
												</div>
											</div>

											<button class="flex-c-m stext-101 cl0 size-112 bg7 bor11 hov-btn3 p-lr-15 trans-04 m-b-10">
												Submit
											</button>
										</form>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>

		<div class="bg6 flex-c-m flex-w size-302 m-t-73 p-tb-15">
			<span class="stext-107 cl6 p-lr-25">
				SKU: JAK-01
			</span>

			<span class="stext-107 cl6 p-lr-25">
				Categories:<%= product.category.name %>
			</span>
		</div>
	</section>


	<!-- Related Products -->
	<section class="sec-relate-product bg0 p-t-45 p-b-105">
		<div class="container">
			<div class="p-b-45">
				<h3 class="ltext-106 cl5 txt-center">
					Related Products
				</h3>
			</div>

			<!-- Slide2 -->
			<div class="wrap-slick2">
				<div class="slick2">
					<% relatedProducts.forEach(relatedProduct=> {%>
						<div class="item-slick2 p-l-15 p-r-15 p-t-15 p-b-15">
							<!-- Block2 -->
							<div class="block2">

								<div class="block2-pic hov-img0">
									<!-- Conditional Offer Price Badge -->
									<% if (relatedProduct.offerPrice) { %>
										<div class="offer-badge-circle">
										<span><%= Math.round((relatedProduct.price - relatedProduct.offerPrice) / relatedProduct.price * 100) %>%</span>
										</div>
									<% } %>
									
								<img src="/uploads/product-images/<%=relatedProduct.image[0]%>" alt="IMG-PRODUCT">

								<a href="/product?id=<%=relatedProduct._id%>" class=" ab-t-l s-full "></a>

								<!-- <a href="#" class="block2-btn flex-c-m stext-103 cl2 size-102 bg0 bor2 hov-btn1 p-lr-15 trans-04 js-show-modal1">
									Quick View
								</a> -->
								<a href="#" class="block2-btn flex-c-m stext-103 cl2 size-102 bg0 bor2 hov-btn1 p-lr-15 trans-04 add-to-cart-btn" data-product-id="<%= relatedProduct._id %>">
									ADD TO CART
								 </a>
							</div>

							<div class="block2-txt flex-w flex-t p-t-14">
								<div class="block2-txt-child1 flex-col-l ">
									<a href="/product?id=<%= relatedProduct._id %>" class="stext-104 cl4 hov-cl1 trans-04 js-name-b2 p-b-6">
										<%=relatedProduct.productName%>
									</a>

									<span class="stext-105 cl3">
										<% if (relatedProduct.offerPrice) { %>
										    <span style="text-decoration: line-through;">₹ <%= relatedProduct.price %></span>
										    ₹ <%= relatedProduct.offerPrice %>
										<% } else { %>
										    ₹ <%= relatedProduct.price %>
										<% } %>
									  </span>
								</div>

								<!-- <div class="block2-txt-child2 flex-r p-t-3">
									<a href="" class="btn-addwish-b2 dis-block pos-relative js-addwish-b2"  data-product-id="<%=relatedProduct._id%>">
										
										<img class="icon-heart2 dis-block trans-04 ab-t-l" src="/assets/images/icons/icon-heart-02.png" alt="ICON">
										
										<img class="icon-heart1 dis-block trans-04" src="/assets/images/icons/icon-heart-01.png" alt="ICON">
					
									</a>
								</div> -->

								<div class="block2-txt-child2 flex-r p-t-3">
									<a href="#" class="btn-addwish-b2 dis-block pos-relative js-addwish-b2" data-product-id="<%= relatedProduct._id%>">
									  <% if (wishlistItems && wishlistItems.includes(relatedProduct._id.toString())) { %>
									    <!-- Show the filled heart icon if the product is in the wishlist -->
									    <img class="icon-heart2 dis-block trans-04 ab-t-l"  src="/assets/images/icons/icon-heart-02.png" alt="ICON">
									    <% } else { %>
										<!-- Show the empty heart icon if the product is not in the wishlist -->
										<img class="icon-heart1 dis-block trans-04" src="/assets/images/icons/icon-heart-01.png" alt="ICON">
									  <% } %>
									</a>
								   </div>
							</div>
						</div>
					</div>
					<%})%>
				</div>
			</div>
		</div>
	</section>
		



	<!-- Back to top -->
	<div class="btn-back-to-top" id="myBtn">
		<span class="symbol-btn-back-to-top">
			<i class="zmdi zmdi-chevron-up"></i>
		</span>
	</div>

	<!-- Modal1 -->
	

	<script src="/assets/js/zoom.js"></script>
 
	<!-- SweetAlert2 CSS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">

<!-- SweetAlert2 JS -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.all.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>



	<script>
		// Assuming you have a stockQuantity variable rendered into your HTML from the server
		const availableQuantity = parseInt(`<%= stockQuantity %>`); // Rendered server-side using EJS, for example
		const quantityInput = document.querySelector('input[name="num-product"]');
		const incrementButton = document.querySelector('.btn-num-product-up');
		const decrementButton = document.querySelector('.btn-num-product-down');

		function updateButtonState() {
		const currentQuantity = parseInt(quantityInput.value);
		
		if (currentQuantity >= availableQuantity) {
			incrementButton.classList.add('disabled');
		} else {
			incrementButton.classList.remove('disabled');
		}
		
		if (currentQuantity <= 1) {
			decrementButton.classList.add('disabled');
		} else {
			decrementButton.classList.remove('disabled');
		}
		}

		function incrementQuantity() {
		let currentQuantity = parseInt(quantityInput.value);

		if (currentQuantity < availableQuantity) {
			quantityInput.value = currentQuantity + 1; 
			updateButtonState();
		} else {
			Swal.fire({
				icon: 'warning',
				title: 'Oops...',
				text: `Maximum quantity available is ${availableQuantity}`,
			});
		}
		}

		function decrementQuantity() {
		let currentQuantity = parseInt(quantityInput.value);

		if (currentQuantity > 1) {
			quantityInput.value = currentQuantity - 1; 
			updateButtonState();
		}
		}

		incrementButton.addEventListener('click', (event) => {
		event.preventDefault();
		if (!incrementButton.classList.contains('disabled')) {
			incrementQuantity();
		}
		});

		decrementButton.addEventListener('click', (event) => {
		event.preventDefault();
		if (!decrementButton.classList.contains('disabled')) {
			decrementQuantity();
		}
		});

		// Initial button state update
		updateButtonState();

		// Add event listener for manual input changes
		quantityInput.addEventListener('input', () => {
		let currentQuantity = parseInt(quantityInput.value);
		
		if (currentQuantity > availableQuantity) {
			quantityInput.value = availableQuantity;
		} else if (currentQuantity < 1 || isNaN(currentQuantity)) {
			quantityInput.value = 1;
		}
		
		updateButtonState();
		});

		// Add CSS for disabled state
		const style = document.createElement('style');
		style.textContent = `
		.btn-num-product-up.disabled,
		.btn-num-product-down.disabled {
			opacity: 0.5;
			cursor: not-allowed;
			pointer-events: none;
		}
		`;
		document.head.appendChild(style);
	 </script>

	 <script>
		document.querySelectorAll('.add-to-cart-btn').forEach(button => {
     button.addEventListener('click', function(event) {
        event.preventDefault();  

        const productId = this.getAttribute('data-product-id');

        // Fetch request to add the product to the cart
        fetch('/add-to-cart', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({ id: productId })
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                // SweetAlert2 popup for success
                Swal.fire({
                    icon: 'success',
                    title: 'Added to cart',
                    text: 'The product has been added to your cart successfully!',
                    timer: 2000,  
                    showConfirmButton: false,
                    position: 'bottom', 
                    toast: true,
				background: '#4CAF50',
				color: '#ffffff',

                });

                // Optionally redirect after showing the success message
                setTimeout(() => {
                    window.location.href = '/cart'; 
                }, 2000);  // Adjust the delay to match the popup display
            } else {
                // SweetAlert2 popup for error
                Swal.fire({
                    icon: 'error',
                    title: 'Oops...',
                    text: data.message || 'Failed to add the product to the cart',
                    timer: 3000,  
                    showConfirmButton: false,
                    position: 'bottom',  
                    toast: true,
				background: '#FF6347', 
            		color: '#ffffff' 
                });
            }
        })
        .catch(error => {
            console.error('Error adding to cart:', error);
            // SweetAlert2 popup for fetch error
            Swal.fire({
                icon: 'error',
                title: 'Error',
                text: 'Something went wrong!',
                timer: 3000,  
                showConfirmButton: false,
                position: 'bottom', 
                toast: true
            });
        });
    });
});
	 </script>
	 
	 <script>
		// Function to add a product to the wishlist
const addToWishlist = async (productId) => {
    try {
        console.log(productId);
        // Make a POST request to the server's addToWishlist endpoint
        const response = await axios.post('/addToWishlist', { productId: productId });

        // Handle the response based on success or failure
        if (response.data.success) {
            // Custom SweetAlert2 popup for successful wishlist addition
            Swal.fire({
                icon: 'success',
                title: 'Congratulations!',
                text: 'Product added to your wishlist successfully!',
                timer: 3000, 
                showConfirmButton: false,
                position: 'bottom', 
                toast: true,
                background: '#4CAF50', 
                color: '#ffffff', 
                customClass: {
                    popup: 'animated slideInDown' 
                }
            });
        } else {
            // Custom SweetAlert2 popup for "Need to login" or other notices
            Swal.fire({
                icon: 'info',
                title: 'Notice',
                text: response.data.message || 'Please log in to add products to your wishlist.',
                confirmButtonText: 'OK',
                background: '#FF9800', 
                color: '#ffffff' 
            });
        }
    } catch (error) {
        console.error("Error adding to wishlist:", error);
        // Custom SweetAlert2 popup for unexpected errors
        Swal.fire({
            icon: 'error',
            title: 'Error',
            text: 'An error occurred while adding the product to wishlist. Please try again.',
            timer: 3000, 
            showConfirmButton: false,
            position: 'bottom', 
            toast: true,
            background: '#FF6347', 
            color: '#ffffff' 
        });
    }
};

// Example usage: When a button is clicked to add a product to the wishlist
document.getElementById("wishlist-btn").addEventListener("click", function() {
    const productId = this.getAttribute("data-product-id");
    addToWishlist(productId); // Call the function with the product ID
});

	 </script>
	 
	 


<!--===============================================================================================-->	
	<script src="/assets/vendor/jquery/jquery-3.2.1.min.js"></script>
<!--===============================================================================================-->
	<script src="/assets/vendor/animsition/js/animsition.min.js"></script>
<!--===============================================================================================-->
	<script src="/assets/vendor/bootstrap/js/popper.js"></script>
	<script src="/assets/vendor/bootstrap/js/bootstrap.min.js"></script>
<!--===============================================================================================-->
	<script src="/assets/vendor/select2/select2.min.js"></script>

	
	<script>
		$(".js-select2").each(function(){
			$(this).select2({
				minimumResultsForSearch: 20,
				dropdownParent: $(this).next('.dropDownSelect2')
			});
		})
	</script>
<!--===============================================================================================-->
	<script src="/assets/vendor/daterangepicker/moment.min.js"></script>
	<script src="/assets/vendor/daterangepicker/daterangepicker.js"></script>
<!--===============================================================================================-->
	<script src="/assets/vendor/slick/slick.min.js"></script>
	<script src="/assets/js/slick-custom.js"></script>
<!--===============================================================================================-->
	<script src="/assets/vendor/parallax100/parallax100.js"></script>
	<script>
        $('.parallax100').parallax100();
	</script>
<!--===============================================================================================-->
	<script src="/assets/vendor/MagnificPopup/jquery.magnific-popup.min.js"></script>
	<script>
		$('.gallery-lb').each(function() { // the containers for all your galleries
			$(this).magnificPopup({
		        delegate: 'a', // the selector for gallery item
		        type: 'image',
		        gallery: {
		        	enabled:true
		        },
		        mainClass: 'mfp-fade'
		    });
		});
	</script>
<!--===============================================================================================-->
	<script src="/assets/vendor/isotope/isotope.pkgd.min.js"></script>
<!--===============================================================================================-->
	<script src="/assets/vendor/sweetalert/sweetalert.min.js"></script>
	
	<script>
$('.js-addwish-b2, .js-addwish-detail').on('click', function(e){
    e.preventDefault();
});

// Handle wishlist button clicks
$('.js-addwish-b2').each(function(){
    var nameProduct = $(this).parent().parent().find('.js-name-b2').html();
    var productId = $(this).attr('data-product-id');

    $(this).on('click', async function(){
        try {
            const response = await axios.post('/addToWishlist', { productId: productId });

            if (response.data.success) {
                // Success alert
                Swal.fire({
                    icon: 'success',
                    title: 'Added to Wishlist',
                    text: `${nameProduct} has been added to your wishlist!`,
                    timer: 2000,
                    showConfirmButton: false,
                    position: 'bottom',
                    toast: true
                });

                $(this).addClass('js-addedwish-b2');
                $(this).off('click');
            } else {
                // Info alert for login required
                Swal.fire({
                    icon: 'info',
                    title: 'Sign in Required',
                    text: response.data.message || 'Please login to add items to wishlist',
                    timer: 3000,
                    showConfirmButton: false,
                    position: 'bottom',
                    toast: true
                });
            }
        } catch (error) {
            console.error("Error adding to wishlist:", error);
            // Error alert
            Swal.fire({
                icon: 'error',
                title: 'Error',
                text: 'Need to login!',
                timer: 3000,
                showConfirmButton: false,
                position: 'bottom',
                toast: true
            });
        }
    });
});

		// $('.js-addwish-detail').each(function(){
		// 	var nameProduct = $(this).parent().parent().parent().find('.js-name-detail').html();

		// 	$(this).on('click', function(){
		// 		swal(nameProduct, "is added to wishlist !", "success");

		// 		$(this).addClass('js-addedwish-detail');
		// 		$(this).off('click');
		// 	});
		// });

		/*---------------------------------------------*/

	// Iterate over each '.js-addcart-detail' element
$('.js-addcart-detail').each(function() {
    const nameProduct = $(this).parent().parent().parent().parent().find('.js-name-detail').html();
    const productId = $(this).data('product-id');

    $(this).on('click', async function() {
        try {
            // Fetch request to add product to cart
            const response = await fetch('/add-to-cart', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ id: productId }) // Send product ID to backend
            });

            // Parse the response as JSON
            const result = await response.json();

            if (response.ok) {
                // SweetAlert2 for successful addition
                Swal.fire({
                    icon: 'success',
                    title: 'Added to Cart!',
                    html: `<strong>${nameProduct}</strong> ${result.message}`,
                    timer: 3000, // Close after 3 seconds
                    showConfirmButton: false,
                    position: 'bottom', // Positioned at bottom
                    toast: true,
                    background: '#4CAF50', // Success background color
                    color: '#ffffff', // Text color for readability
                    customClass: {
                        popup: 'animated slideInDown' // Custom animation class
                    }
                });
            } else {
                // SweetAlert2 for errors from backend
                Swal.fire({
                    icon: 'error',
                    title: 'Error!',
                    html: `<strong>${nameProduct}</strong> ${result.message || 'Error adding to cart!'}`,
                    timer: 3000,
                    showConfirmButton: false,
                    position: 'bottom',
                    toast: true,
                    background: '#FF6347', // Error background color
                    color: '#ffffff' // Text color
                });
            }
        } catch (error) {
            console.error('Error adding to cart:', error);
            // SweetAlert2 for unexpected errors
            Swal.fire({
                icon: 'error',
                title: 'Oops!',
                text: 'An unexpected error occurred. Please try again.',
                timer: 3000,
                showConfirmButton: false,
                position: 'bottom',
                toast: true,
                background: '#FF6347',
                color: '#ffffff'
            });
        }
    });
});



	
	</script>
<!--===============================================================================================-->
	<script src="/assets/vendor/perfect-scrollbar/perfect-scrollbar.min.js"></script>
	<script>
		$('.js-pscroll').each(function(){
			$(this).css('position','relative');
			$(this).css('overflow','hidden');
			var ps = new PerfectScrollbar(this, {
				wheelSpeed: 1,
				scrollingThreshold: 1000,
				wheelPropagation: false,
			});

			$(window).on('resize', function(){
				ps.update();
			})
		});
	</script>
<!--===============================================================================================-->
	<script src="/assets/js/main.js"></script>

</body>
</html>
<%- include("../layout/commonFooter.ejs")%>