
<%- include("../layout/homeheader.ejs")%>


<style>
	.offer-badge-ribbon {
	    position: absolute;
	    top: 10px;
	    left: -5px;
	    padding: 5px 10px;
	    background: #ff0000;
	    color: #ffffff;
	    font-size: 12px;
	    font-weight: bold;
	    box-shadow: 0 2px 4px rgba(0,0,0,0.2);
	    z-index: 10;
	}
	.offer-badge-ribbon:before {
	    content: "";
	    position: absolute;
	    top: 100%;
	    left: 0;
	    border-top: 5px solid #cc0000;
	    border-left: 5px solid transparent;
	}
	.original-price {
	    text-decoration: line-through;
	    color: #999;
	    margin-right: 5px;
	}
	.offer-price {
	    color: #ff0000;
	    font-weight: bold;
	}
	.block2-pic:hover .offer-badge-ribbon {
	    opacity: 1;
	    visibility: visible;
	}
	
 </style>
	
	<!-- Slider -->
	<section class="section-slide">
		<div class="wrap-slick1">
			
			<div class="slick1">
				<div class="item-slick1" style="background-image: url(/assets/images/daniel-hay-O703kpzIsQI-unsplash.jpg);">
					<div class="container h-full">
						<div class="flex-col-l-m h-full p-t-100 p-b-30 respon5">
							<div class="layer-slick1 animated visible-false" data-appear="fadeInDown" data-delay="0">
								<span class="ltext-101 cl2 respon2">
									Women Collection 2018
								</span>
							</div>
								
							<div class="layer-slick1 animated visible-false" data-appear="fadeInUp" data-delay="800">
								<h2 class="ltext-201 cl2 p-t-19 p-b-43 respon1">
									NEW SEASON
								</h2>
							</div>
								
							<div class="layer-slick1 animated visible-false" data-appear="zoomIn" data-delay="1600">
								<a href="/shope" class="flex-c-m stext-101 cl0 size-101 bg1 bor1 hov-btn1 p-lr-15 trans-04">
									Shop Now
								</a>
							</div>
						</div>
					</div>
				</div>

				<div class="item-slick1" style="background-image: url(/assets/images/pexels-pixabay-364822.jpg);">
					<div class="container h-full">
						<div class="flex-col-l-m h-full p-t-100 p-b-30 respon5">
							<div class="layer-slick1 animated visible-false" data-appear="rollIn" data-delay="0">
								<span class="ltext-101 cl2 respon2">
									Men New-Season
								</span>
							</div>
								
							<div class="layer-slick1 animated visible-false" data-appear="lightSpeedIn" data-delay="800">
								<h2 class="ltext-201 cl2 p-t-19 p-b-43 respon1">
									Jackets & Coats
								</h2>
							</div>
								
							<div class="layer-slick1 animated visible-false" data-appear="slideInUp" data-delay="1600">
								<a href="/shope" class="flex-c-m stext-101 cl0 size-101 bg1 bor1 hov-btn1 p-lr-15 trans-04">
									Shop Now
								</a>
							</div>
						</div>
					</div>
				</div>

				<div class="item-slick1" style="background-image: url(/assets/images/alvin-rahul-oZ-SRyjW76k-unsplash.jpg);">
					<div class="container h-full">
						<div class="flex-col-l-m h-full p-t-100 p-b-30 respon5">
							<div class="layer-slick1 animated visible-false" data-appear="rotateInDownLeft" data-delay="0">
								<span class="ltext-101 cl2 respon2">
									Men Collection 2018
								</span>
							</div>
								
							<div class="layer-slick1 animated visible-false" data-appear="rotateInUpRight" data-delay="800">
								<h2 class="ltext-201 cl2 p-t-19 p-b-43 respon1">
									New arrivals
								</h2>
							</div>
								
							<div class="layer-slick1 animated visible-false" data-appear="rotateIn" data-delay="1600">
								<a href="/shope" class="flex-c-m stext-101 cl0 size-101 bg1 bor1 hov-btn1 p-lr-15 trans-04">
									Shop Now
								</a>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</section>


	<!-- Banner -->
	<div class="sec-banner bg0 p-t-80 p-b-50">
		<div class="container">
			<div class="row">
				<%if(products){%>
				<%products.slice(0,3).forEach(product => {%>
				<div class="col-md-6 col-xl-4 p-b-30 m-lr-auto">
					<!-- Block1 -->
					<div class="block1 wrap-pic-w">

						

						<img src="/uploads/product-images/<%=product.image[0]%>" alt="IMG-BANNER">

						<a href="/product?id=<%=product._id%>" class="block1-txt ab-t-l s-full flex-col-l-sb p-lr-38 p-tb-34 trans-03 respon3">
							<div class="block1-txt-child1 flex-col-l">
								<span class="block1-name ltext-102 trans-04 p-b-8">
									<%=product.brand.brandName%>
								</span>

								<span class="block1-info stext-102 trans-04">
									Spring 2018
								</span>
							</div>

							<div class="block1-txt-child2 p-b-4 trans-05">
								<div class="block1-link stext-101 cl0 trans-09">
									Shop Now
								</div>
							</div>
						</a>
					</div>
				</div>
				<%})%>
				<%}%>
			</div>
		</div>
	</div>


	<!-- Product -->
	<section class="bg0 p-t-23 p-b-140 ">
		<div class="container">
			<div class="p-b-10">
				<h3 class="ltext-103 cl5 ">
					Product Overview
				</h3>
			</div>

			<br>
			<br>
			<br>

			<div class="row isotope-grid">
				<%products.forEach(product=>{%>
				<div class="col-sm-6 col-md-4 col-lg-3 p-b-35 isotope-item women">
				    <!-- Block2 -->
				    <div class="block2">
					   <div class="block2-pic hov-img0">
						  <!-- Ribbon Offer Price Badge -->
						  <% if (product.offerPrice) { %>
							 <div class="offer-badge-ribbon">
								<span><%= Math.round((product.price - product.offerPrice) / product.price * 100) %>% OFF</span>
							 </div>
						  <% } %>
			 
						  <img src="/uploads/product-images/<%=product.image[0]%>" alt="IMG-PRODUCT">
						  <a href="/product?id=<%=product._id%>" class="ab-t-l s-full"></a>
			 
						  <a href="#" class="block2-btn flex-c-m stext-103 cl2 size-102 bg0 bor2 hov-btn1 p-lr-15 trans-04 add-to-cart-btn" data-product-id="<%= product._id %>">
							 ADD TO CART
						  </a>
					   </div>
			 
					   <div class="block2-txt flex-w flex-t p-t-14">
						  <div class="block2-txt-child1 flex-col-l ">
							 <a href="/product?id=<%= product._id %>" class="stext-104 cl4 hov-cl1 trans-04 js-name-b2 p-b-6">
								<%=product.productName%>
							 </a>
			 
							 <span class="stext-105 cl3">
								<% if (product.offerPrice) { %>
								    <span class="original-price">₹ <%= product.price %></span>
								    <span class="offer-price">₹ <%= product.offerPrice %></span>
								<% } else { %>
								    ₹ <%= product.price %>
								<% } %>
							 </span>
						  </div>
			 
						  <div class="block2-txt-child2 flex-r p-t-3">
							<a href="#" class="btn-addwish-b2 dis-block pos-relative js-addwish-b2" data-product-id="<%= product._id %>">
							  <% if (wishlistItems && wishlistItems.includes(product._id.toString())) { %>
							    <!-- Show the filled heart icon if the product is in the wishlist -->
							    <img class="icon-heart2 dis-block trans-04 ab-t-l"  src="/assets/images/icons/icon-heart-02.png" alt="ICON">
							    <% } else { %>
								<!-- Show the empty heart icon if the product is not in the wishlist -->
								<img class="icon-heart1 dis-block trans-04" src="/assets/images/icons/icon-heart-01.png" alt="ICON">
							  <% } %>
							</a>
						   </div>
						   
					   </div>
				    </div>
				</div>
				<%})%>
			 </div>

			<!-- Load more -->
			<div class="flex-c-m flex-w w-full p-t-45">
				<a href="#" class="flex-c-m stext-101 cl5 size-103 bg2 bor1 hov-btn1 p-lr-15 trans-04">
					Load More
				</a>
			</div>
		</div>
	</section>



	<!-- Back to top -->
	<div class="btn-back-to-top" id="myBtn">
		<span class="symbol-btn-back-to-top">
			<i class="zmdi zmdi-chevron-up"></i>
		</span>
	</div>

	<!-- Modal1 -->
	<div class="wrap-modal1 js-modal1 p-t-60 p-b-20">
		<div class="overlay-modal1 js-hide-modal1"></div>

		<div class="container">
			<div class="bg0 p-t-60 p-b-30 p-lr-15-lg how-pos3-parent">
				<button class="how-pos3 hov3 trans-04 js-hide-modal1">
					<img src="/assets/images/icons/icon-close.png" alt="CLOSE">
				</button>

				<div class="row">
					<div class="col-md-6 col-lg-7 p-b-30">
						<div class="p-l-25 p-r-30 p-lr-0-lg">
							<div class="wrap-slick3 flex-sb flex-w">
								<div class="wrap-slick3-dots"></div>
								<div class="wrap-slick3-arrows flex-sb-m flex-w"></div>

								<div class="slick3 gallery-lb">
									<div class="item-slick3" data-thumb="images/product-detail-01.jpg">
										<div class="wrap-pic-w pos-relative">
											<img src="/assets/images/product-detail-01.jpg" alt="IMG-PRODUCT">

											<a class="flex-c-m size-108 how-pos1 bor0 fs-16 cl10 bg0 hov-btn3 trans-04" href="images/product-detail-01.jpg">
												<i class="fa fa-expand"></i>
											</a>
										</div>
									</div>

									<div class="item-slick3" data-thumb="images/product-detail-02.jpg">
										<div class="wrap-pic-w pos-relative">
											<img src="/assets/images/product-detail-02.jpg" alt="IMG-PRODUCT">

											<a class="flex-c-m size-108 how-pos1 bor0 fs-16 cl10 bg0 hov-btn3 trans-04" href="images/product-detail-02.jpg">
												<i class="fa fa-expand"></i>
											</a>
										</div>
									</div>

									<div class="item-slick3" data-thumb="images/product-detail-03.jpg">
										<div class="wrap-pic-w pos-relative">
											<img src="/assets/images/product-detail-03.jpg" alt="IMG-PRODUCT">

											<a class="flex-c-m size-108 how-pos1 bor0 fs-16 cl10 bg0 hov-btn3 trans-04" href="images/product-detail-03.jpg">
												<i class="fa fa-expand"></i>
											</a>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
					
					<div class="col-md-6 col-lg-5 p-b-30">
						<div class="p-r-50 p-t-5 p-lr-0-lg">
							<h4 class="mtext-105 cl2 js-name-detail p-b-14">
								Lightweight Jacket
							</h4>

							<span class="mtext-106 cl2">
								$58.79
							</span>

							<p class="stext-102 cl3 p-t-23">
								Nulla eget sem vitae eros pharetra viverra. Nam vitae luctus ligula. Mauris consequat ornare feugiat.
							</p>
							
							<!--  -->
							<div class="p-t-33">
								<div class="flex-w flex-r-m p-b-10">
									<div class="size-203 flex-c-m respon6">
										Size
									</div>

									<div class="size-204 respon6-next">
										<div class="rs1-select2 bor8 bg0">
											<select class="js-select2" name="time">
												<option>Choose an option</option>
												<option>Size S</option>
												<option>Size M</option>
												<option>Size L</option>
												<option>Size XL</option>
											</select>
											<div class="dropDownSelect2"></div>
										</div>
									</div>
								</div>

								<div class="flex-w flex-r-m p-b-10">
									<div class="size-203 flex-c-m respon6">
										Color
									</div>

									<div class="size-204 respon6-next">
										<div class="rs1-select2 bor8 bg0">
											<select class="js-select2" name="time">
												<option>Choose an option</option>
												<option>Red</option>
												<option>Blue</option>
												<option>White</option>
												<option>Grey</option>
											</select>
											<div class="dropDownSelect2"></div>
										</div>
									</div>
								</div>

								<div class="flex-w flex-r-m p-b-10">
									<div class="size-204 flex-w flex-m respon6-next">
										<div class="wrap-num-product flex-w m-r-20 m-tb-10">
											<div class="btn-num-product-down cl8 hov-btn3 trans-04 flex-c-m">
												<i class="fs-16 zmdi zmdi-minus"></i>
											</div>

											<input class="mtext-104 cl3 txt-center num-product" type="number" name="num-product" value="1">

											<div class="btn-num-product-up cl8 hov-btn3 trans-04 flex-c-m">
												<i class="fs-16 zmdi zmdi-plus"></i>
											</div>
										</div>

										<button class="flex-c-m stext-101 cl0 size-101 bg1 bor1 hov-btn1 p-lr-15 trans-04 js-addcart-detail">
											Add to cart
										</button>
									</div>
								</div>	
							</div>

							<!--  -->
							<div class="flex-w flex-m p-l-100 p-t-40 respon7">
								<div class="flex-m bor9 p-r-10 m-r-11">
									<a href="#" class="fs-14 cl3 hov-cl1 trans-04 lh-10 p-lr-5 p-tb-2 js-addwish-detail tooltip100" data-tooltip="Add to Wishlist">
										<i class="zmdi zmdi-favorite"></i>
									</a>
								</div>

								<a href="#" class="fs-14 cl3 hov-cl1 trans-04 lh-10 p-lr-5 p-tb-2 m-r-8 tooltip100" data-tooltip="Facebook">
									<i class="fa fa-facebook"></i>
								</a>

								<a href="#" class="fs-14 cl3 hov-cl1 trans-04 lh-10 p-lr-5 p-tb-2 m-r-8 tooltip100" data-tooltip="Twitter">
									<i class="fa fa-twitter"></i>
								</a>

								<a href="#" class="fs-14 cl3 hov-cl1 trans-04 lh-10 p-lr-5 p-tb-2 m-r-8 tooltip100" data-tooltip="Google Plus">
									<i class="fa fa-google-plus"></i>
								</a>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

	<script>
		document.querySelectorAll('.add-to-cart-btn').forEach(button => {
		button.addEventListener('click', function(event) {
		   event.preventDefault();  
	
		   const productId = this.getAttribute('data-product-id');
	
		   // Fetch request to add the product to the cart
		   fetch('/add-to-cart', {
			  method: 'POST',
			  headers: {
				 'Content-Type': 'application/json'
			  },
			  body: JSON.stringify({ id: productId })
		   })
		   .then(response => response.json())
		   .then(data => {
			  if (data.success) {
				 // SweetAlert2 popup for success
				 Swal.fire({
					icon: 'success',
					title: 'Added to cart',
					text: 'The product has been added to your cart successfully!',
					timer: 2000,  
					showConfirmButton: false,
					position: 'bottom',  
					toast: true
				 });
	
				  
			  } else {
				 // SweetAlert2 popup for error
				 Swal.fire({
					icon: 'error',
					title: 'Oops...',
					text: data.message || 'Failed to add the product to the cart',
					timer: 3000,  
					showConfirmButton: false,
					position: 'bottom',  
					toast: true
				 });
			  }
		   })
		   .catch(error => {
			  console.error('Error adding to cart:', error);
			  // SweetAlert2 popup for fetch error
			  Swal.fire({
				 icon: 'error',
				 title: 'Error',
				 text: 'Need to login!',
				 timer: 3000,  
				 showConfirmButton: false,
				 position: 'bottom',  
				 toast: true
			  });
		   });
	    });
	});
		 </script>

<script>
	document.addEventListener('DOMContentLoaded', function() {
	    const referrarName = '<%= locals.referrarName %>';
	    
	    if (referrarName && referrarName !== 'null') {
		   Swal.fire({
			  icon: 'success',
			  title: 'Welcome!',
			  text: `You were referred by ${referrarName}`,
			  timer: 3000,
			  showConfirmButton: false,
			  position: 'bottom',
			  toast: true,
			  background: '#4CAF50',
			  color: '#ffffff',
			  customClass: {
				 popup: 'animated slideInDown'
			  }
		   });
 
		   // Clear the referral name from session after showing
		//    fetch('/clear-referral', {
		// 	  method: 'POST',
		// 	  headers: {
		// 		 'Content-Type': 'application/json'
		// 	  }
		//    }).catch(error => console.log('Error clearing referral:', error));
	    }
	});
 </script>

<%- include("../layout/homefooter.ejs")%>